<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Form To Google Sheets Demo</title>
  <link href="./favicon.png" rel="shortcut icon">

  <link rel="stylesheet" href="main.css">

</head>
<body>

  <div class="form-container">
    <form name="submit-to-google-sheet">
      <input name="email" type="email" placeholder="Email" required>
      <input name="firstName" type="text" placeholder="First Name">
      <input name="lastName" type="text" placeholder="Last Name">
      <button type="submit">Subscribe</button>
    </form>

    <div class="loading js-loading is-hidden">
      <div class="loading-spinner">
        <svg><circle cx="25" cy="25" r="20" fill="none" stroke-width="2" stroke-miterlimit="10"/></svg>
      </div>
    </div>
  </div>

  
  <script>
    const scriptURL = 'https://script.google.com/macros/s/AKfycbzwXqzlNTSudGcXedJS0urM4ya2AbS948ujUgBa7IDnKqxuCX7RYmgytSUEcMPfS1Q/exec'

    const form = document.forms['submit-to-google-sheet']

    form.addEventListener('submit', e => {
      e.preventDefault()
      fetch(scriptURL, { method: 'POST', body: new FormData(form)})
      .then(response => alert("Confirm Your Payment !"))
      .then(() => { window.location.reload(); })
      .catch(error => console.error('error!', error.message))
    })
</script>
<script>
  // Mengecek apakah sessionStorage memiliki data pengguna
  if (!sessionStorage.getItem('username')) {
      // Jika data nama pengguna tidak ada, redirect ke session_index.html
      window.location.href = 'session_index.html';
  } else {
      // Jika ada, tampilkan pesan selamat datang
      document.getElementById('greeting').innerText = 'Selamat datang, ' + sessionStorage.getItem('username') + '!';
  }
</script>

</body>
</html>
